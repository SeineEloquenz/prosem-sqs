%! Suppress = Unicode
\documentclass[a4paper,UKenglish,cleveref, autoref]{templates/lipics-v2019}
\usepackage{csquotes}
\usepackage{url}
\usepackage{pgfplots}
\usepackage{float}
%This is a template for producing LIPIcs articles.
%See lipics-manual.pdf for further information.
%for A4 paper format use option "a4paper", for US-letter use option "letterpaper"
%for british hyphenation rules use option "UKenglish", for american hyphenation rules use option "USenglish"
%for section-numbered lemmas etc., use "numberwithinsect"
%for enabling cleveref support, use "cleveref"
%for enabling cleveref support, use "autoref"

\include{commands}

\graphicspath{{./graphics/}}%helpful if your graphic files are in another directory

\bibliographystyle{plainurl}% the mandatory bibstyle

\title{M10: \sqss}

\titlerunning{M10: \sqss}%optional, please use if title is longer than one line

\author{Alexander Linder}{Karlsruhe Institute of Technology, Germany \and \url{https://kit.edu} }{alexander.linder@student.kit.edu}{}{}
%mandatory, please use full name; first two parameters are mandatory, other parameters can be empty.

\authorrunning{A. Linder}
%mandatory. First: Use abbreviated first/middle names. Second (only in severe cases): Use first author plus 'et al.'

\Copyright{Alexander Linder}
%%mandatory, please use full first names. LIPIcs license is "CC-BY";  http://creativecommons.org/licenses/by/3.0/

\ccsdesc[100]{Software and its engineering~Software reliability}
%mandatory: Please choose ACM 2012 classifications from https://dl.acm.org/ccs/ccs_flat.cfm

\keywords{\misra, \sqss}
%mandatory; please add comma-separated list of keywords

\category{}
%optional, e.g. invited paper

\relatedversion{}
%optional, e.g. full version hosted on arXiv, HAL, or other respository/website

\supplement{}
%optional, e.g. related research data, source code, ... hosted on a repository like zenodo, figshare, GitHub, ...

\funding{}
%optional, to capture a funding statement, which applies to all authors. Please enter author specific funding statements as fifth argument of the \author macro.

\acknowledgements{}
%optional

\nolinenumbers %uncomment to disable line numbering

\hideLIPIcs  %uncomment to remove references to LIPIcs series (logo, DOI, ...), e.g. when preparing a pre-final version to be uploaded to arXiv or another public repository

%Editor-only macros:: begin (do not touch as author)%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\EventEditors{}
\EventNoEds{0}
\EventLongTitle{Proseminar Werkzeuge und Methoden der Software-Analyse}
\EventShortTitle{Proseminar}
\EventAcronym{Proseminar}
\EventYear{2019}
\EventDate{WS19/20}
\EventLocation{Karlsruhe, Deutschland}
\EventLogo{}
\SeriesVolume{}
\ArticleNo{M10}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{document}

    \maketitle

    \begin{abstract}
        Diese Arbeit gibt einen Überblick über \sqss\ im Allgemeinen, unter besonderer Betrachtung eines weitverbreiteten Beispiels: \misra\ 2004.\\
        Es wird die hinter \sqss\ stehende Motivation dargebracht, sowie betrachtet, wie sich Regeln innerhalb eines Standards sinnvoll klassifizieren lassen.
        Dies führt zum Begriff des \slss\ nach Hatton, welches formale Forderungen an einen guten Regelsatz aufstellt.
        Weiterhin wird überprüft, inwiefern \misra\ diese Definition erfüllt.\\
        Final sollen Gütekriterien für \sqss\ aufgestellt und die Güte des \misra\ Standards unter eben diesen Kriterien bewertet werden.
        %TODO Add analysis and conclusion
    \end{abstract}

    \section{Einleitung}
    \label{sec:einleitung}

    \section{\misra}
    \label{sec:misra-c}
    \misra\ ist ein weitverbreiteter \sqs, der von der \textbf{M}otor \textbf{I}ndustry \textbf{S}oftware \textbf{R}eliability \textbf{A}ssociation (MISRA) entwickelt wurde.
    Die erste Version von \misra\ wurde 1998 veröffentlicht, mit insgesamt zwei großen Revisionen einmal 2004 sowie 2012,
    wobei sich diese Arbeit auf die Standards von 1998 (künftig M1998) und 2004 (künftig M2004) beschränkt, da einerseits der Standard von 2004 nach wie vor
    weite Verbreitung findet und sich andererseits die Forschung auf diese beiden Versionen konzentriert.\\
    Bei \misra\ handelt es sich um den de facto Standard zur Programmierung eingebetteter Systeme in der Mehrheit der sicherheitsrelevanten Industrien in der Programmiersprache C\@.\cite{misra-website}
    Sowohl M1998 als auch M2004 nehmen Bezug auf C89/90 und nicht auf den neueren C-Standard C99 (ISO/IEC9899:1999), was dazu führt, dass neuere Sprachkonstrukte in
    \misra-konformem Code nicht erlaubt sind, auch wenn die verwendeten Compiler sie unterstützen.

    \subsection{Evolution des Standards}
    \label{subsec:evolution-des-standards}

    %TODO Add section

    \begin{figure}[H]
        \centering
        \captionsetup{justification=centering,margin=2cm}
        \include{graphics/pie1998-2004}
        \caption{Regelanzahl 1998 vs 2004}
    \end{figure}

    \subsection{Beispielregel}
    \label{subsec:beispielregel}

    %TODO Add text for example rule explaining why its printed here and why this style is problematic

    \noindent
    \begin{minipage}{\linewidth}
        \begin{example}
            \textbf{Rule 2.1 (required): Assembly language shall be encapsulated and isolated\cite{MISRA2004}}\\
            Where assembly language instructions are required it is recommended that they be encapsulated
            and isolated in either (a) assembler functions, (b) C functions or (c) macros.\\
            For reasons of efficiency it is sometimes necessary to embed simple assembly language instructions
            in-line, for example to enable and disable interrupts.
            If it is necessary to do this for any reason, then it is recommended that it be achieved by using macros.\\
            Note that the use of in-line assembly language is an extension to standard C, and therefore also
            requires a deviation against Rule 1.1.
            \begin{lstlisting}[language=C]
                #define NOP asm(" NOP")
            \end{lstlisting}
        \end{example}
    \end{minipage}

    \section{Regelklassifizierung}
    \label{sec:regelklassifizierung}
    In diesem Abschnitt wollen wir untersuchen, wie wir Regeln eines Regelsatzes sinnvoll klassifizieren können.
    Hierfür gibt es viele verschiedene Möglichkeiten.
    Im vorigen Abschnitt haben wir bereits gesehen, wie der Regelsatz von \misra\ organisiert wird.
    Hierbei handelte es sich schlicht um eine thematische Organisation der Regeln in Gruppen.
    Wir wollen nun eine alternative Klassifikationsart betrachten, die nicht auf dem Inhalt der Regeln, sondern auf ihrer
    Art sowie dem Grad an Evidenz, der ihre Existenz begründet, basiert.
    Regeln werden in diesem System nach Hatton in drei Typen unterschieden, einserseits Typ-A (\enquote{Style-basierte}) Regeln,
    andererseits Typ-B (\enquote{funktionale}) Regeln, welche sich weiter in Typ-B.1 (\enquote{Subjektive}) sowie
    Typ B.2 (\enquote{Evidente}) unterscheiden lassen.\cite{hatton2004safer}\\
    Im Folgenden wollen wir uns die verschiedenen Regelklassen je an einem Beispiel für eine Regel und ihre Verletzung
    genauer ansehen.\\
    Alle verwendeten Beispielregeln stammen hierbei aus \misra.

    \subsection{Typ-A Regeln}
    \label{subsec:typ-a-regeln}
    \begin{definition}
        Eine Typ-A Regel sei eine Regel, welche alleinig den Stil des Codes beeinflusst.
    \end{definition}

    Ein Beispiel für eine Typ-A Regel stellt Regel 5.7 \textit{No identifier name should be reused}
    (Kein Variablenname soll wiederverwendet werden) dar.\cite{MISRA2004}\\
    Betrachten wir folgendes Code-Beispiel:

    \noindent
    \begin{minipage}{\linewidth}
        \begin{example}
            \lstinputlisting[title=\ ]{graphics/typa.c}
        \end{example}
    \end{minipage}

    Im Beispiel besitzen die Structs \textit{air\_speed} und \textit{gnd\_speed} je eine Membervariable \textit{speed}.
    Durch die unterschiedlichen Einheiten für Geschwindigkeit in der Luft bzw.\ am Boden besteht hier eine potentielle
    Fehlerquelle.
    Durch Umbenennung der Variablen in bspw.\ \textit{speed\_knots} und \textit{speed\_kmh} kann diese ausgeräumt werden,
    da klar wird, dass eine Konversion der Geschwindigkeiten stattfinden muss, bevor diese gemeinsam verwendet, bspw.\ verglichen,
    werden können.
    Ungeachtet dieser Fehlerquelle handelt es sich jedoch um ein rein stilistisches Problem, weshalb diese Regel in
    Kategorie A fällt.

    \subsection{Typ-B.1 Regeln}
    \label{subsec:typ-b-1-regeln}
    \begin{definition}
        Eine Typ-B.1 Regel sei eine Regel, welche potentiell unsichere Sprachfeatures ausschließt,
        jedoch keine empirischen Daten besitzt, die diesen Ausschluss begründen.
    \end{definition}

    Das klassische Beispiel schlechthin für eine Typ-B.1 Regel stellt Regel 14.4 \textit{The goto statement shall not be used}
    (Die goto Anweisung soll nicht verwendet werden) dar.\cite{MISRA2004}
    Betrachten wir einmal folgendes Beispiel einer noch recht konservativen Verwendung des \textit{goto} rein zur
    Fehlerbehandlung:

    \noindent
    \begin{minipage}{\linewidth}
        \begin{example}
            \lstinputlisting[title=\ ]{graphics/typb1.c}
        \end{example}
    \end{minipage}

    Im Falle dass \textit{some Condition} eintritt, springt die Programmausführung zur Sprungmarke \textit{error}.
    Diese ist in einer \enquote{\textit{goto}-freien} Ausführung nicht erreichbar, da sie nach der ersten \textit{return}
    Anweisung steht.
    Wollen wir die Programmausführung analysieren müssen wir somit alle Verwendungen von \textit{goto} finden,
    um zu verstehen wann die \textit{error} Marke erreicht wird.
    \textit{Goto} erhöht damit die Komplexität von Programmen enorm, indem es die Lücke zwischen statischem
    Quelltext und darauf basierender Programmausführung vergrößert.\cite{goto-harmful}
    Eine empirische Datenbasis liefert uns diese Intuition nicht, dennoch enthält gemäß \cite{hatton2004safer}
    nahezu jeder \sqs\ eine Regel dieser Form.\\
    Es handelte sich damit lange um \textit{das} Beispiel schlechthin für Typ-B.1 Regeln.
    Die von Hatton beschriebene klare Absenz von faktischer Untermauerung muss jedoch insofern in Frage gestellt werden,
    dass der Autor in~\cite{goto-study} eine Analyse der Auswirkung von \textit{goto} in Cobol-Programmen fand, die eine
    Korrelation der Nutzung von \textit{goto} mit geringerer Programmqualität nahelegt.
    Mit weiterer Faktenuntermauerung könnte unser Beispiel damit auch in die Kategorie B.2 wandern, die im Folgenden
    betrachtet wird.

    \subsection{Typ-B.2 Regeln}
    \label{subsec:typ-b-2-regeln}
    \begin{definition}
        Eine Typ-B.2 Regel sei eine Regel, welche potentiell unsichere Sprachfeatures ausschließt und empirische
        Daten besitzt, die diesen Ausschluss begründen.
    \end{definition}

    Typ-B.2 Regeln stellen damit sozusagen den \enquote{Goldstandard} für Regeln in einem \sqs\ dar.
    Sie sind weder rein stilistisch wie Typ-A Regeln, noch begründen sie sich auf Intuition wie Typ-B.1 Regeln.
    Betrachten wir im Folgenden die Regel 9.1 \textit{All automatic variables shall have been asigned a value before being used}
    (Alle lokalen Variablen müssen vor Benutzung initialisiert werden).\cite{MISRA2004}\\
    Ein Beispiel:

    \noindent
    \begin{minipage}{\linewidth}
        \begin{example}
            \lstinputlisting[title=\ ]{graphics/typb2.c}
        \end{example}
    \end{minipage}

    Im dargestellten Listing wird eine Variable \textit{speed} deklariert, aber nicht initialisiert.
    Der erweiternde Erklärungstext in~\cite{MISRA2004} zu Regel 9.1 erlaubt eine spätere Initialisierung ausdrücklich, verlangt jedoch, dass
    in jedem Fall die Variable vor einem lesenden Zugriff beschrieben werden muss.
    Dies ist hier offensichtlich nicht der Fall, da \textit{speed} nur im Falle dass \textit{some Condition} eintritt auf
    \textit{101} gesetzt wird, andernfalls bleibt ihr Wert undefiniert.
    Damit ist ab dem lesenden Zugriff in der darauffolgenden If-Abfrage das Verhalten des Programms potentiell undefiniert.
    Es ist bereits intuitiv klar, warum es sich hierbei um eine Fehlerquelle handelt, jedoch gibt es hierzu auch explizit
    empirische Fehlerdaten, wie von Hatton dargelegt.\cite{hatton2004safer}

    \section{Safer Language Subsets}
    \label{sec:safer-language-subsets}

    %TODO Add introduction to sls

    \begin{definition}
        Ein Regelsatz $R$ sei ein \sls $\iff$
        \begin{itemize}
            \item $R$ enthält nur Typ B.2 Regeln als verpflichtende Regeln
            \item $R$ enthält nur Typ B.1 Regeln als empfohlene Regeln
            \item $R$ enthält keinerlei Typ A Regeln
        \end{itemize}
        
    \end{definition}
    
    \section{Bewertung}
    \label{sec:bewertung}

    %TODO Add introductory paragraph

    \subsection{Signal-Rausch-Rate und False Positives}
    \label{subsec:signal-rausch-rate-und-false-positives}

    %TODO Explain what signal-noise-ratio means in context
    Unter der Signal-Rausch-Rate eines Standards verstehen wir die Rate mit der das Auftreten eines Verstoßes gegen den Regelsatz mit einem
    tatsächlichen Defekt korreliert.
    Großes Rauschen führt dazu, dass die Wahrscheinlichkeit dass ein Verstoß mit einem Defekt einhergeht, abnimmt.
    Ein Standard ist demnach \enquote{gut}, wenn die Signal-Rausch-Rate möglichst gering ist.\\
    Sei $p > 0$ sei die Wahrscheinlichkeit, mit der eine Korrektur einer Regelübertretung zur Einführung eines neuen Defekts
    etwa desselben Schweregrads führt.
    Diese Wahrscheinlichkeit existiert gemäß~\cite{transgression-data} und~\cite{hatton2007language} und beträgt in
    Adams Arbeit etwa den Wert $0,15$.\\
    Um nun die Relevanz von False Positives analysieren zu können betrachten wir die Rate $f$ mit der der Standard
    bei einer Regelübertretung auch einen Fault findet sowie die Rate $g$ mit der ein Verstoß einen False Positive, also
    einen Regelverstoß ohne assoziierten Fault, darstellt.
    Damit kann nun die gesamte Anzahl an Faults nach Korrektur aller Verstöße berechnet werden:
    \begin{lemma}
        Die gesamte Anzahl Faults nach Korrektur aller Regelverstöße gegen einen Standard berechnet sich als $fp + gp$
    \end{lemma}

    Da es zu Beginn jedoch bereits $f$ Faults gab, besteht die Möglichkeit dass ein stark rauschender Standard die Anzahl
    an Faults erhöht.
    Dies ist dann der Fall, wenn $fp + gp > f$ gilt.
    Dies lässt sich mittels Äquivalenzumformungen vereinfachen und führt damit zu:

    \begin{theorem}
        Die gesamte Anzahl Faults erhöht sich nach Korrektur aller Verstöße gegen einen Standard $\iff$
        \begin{gather*}
            \frac{f}{g} < \frac{p}{1-p}
        \end{gather*}
    \end{theorem}


    %TODO Explain graphics below
    In Figure~\ref{fig:1998-transgression-rates} und Figure~\ref{fig:2004-transgression-rates} werden anhand von sieben
    Softwarepaketen die kumulierten Verstöße je 1000 Codezeilen für M1998 bzw.\ M2004 je Regel dargestellt.
    Diese Untersuchung aus~\cite{hatton2007language} zeigt, dass mit der Einführung von M2004 die Rate der False Positives
    um lediglich $29\%$ gesunken ist.
    Damit folgt gemäß der Betrachtungen aus~\cite{hatton2007language} gemeinsam mit den Daten aus~\cite{transgression-data}
    dass M2004 noch immer in jenem Bereich liegt, in dem eine Korrektur aller Verstöße die Anzahl an Faults
    eher erhöht als verringert.\\
    Daraus muss geschlossen werden, dass Misra in seiner Reinform ungeeignet ist und eine sorgfältige Regelauswahl erfolgen
    muss um aus dem Standard einen Nutzen zu ziehen.

    \begin{figure}[H]
        \centering
        \captionsetup{justification=centering,margin=2cm}
        \includegraphics[width=\textwidth]{graphics/1998-transgression-rates.png}
        \caption{Verstöße in Warnungen je 1000 Codezeilen auf 7 Pakete verteilt, M1998\cite{hatton2007language}}
        \label{fig:1998-transgression-rates}
    \end{figure}

    \begin{figure}[H]
        \centering
        \captionsetup{justification=centering,margin=2cm}
        \includegraphics[width=\textwidth]{graphics/2004-transgression-rates.png}
        \caption{Verstöße in Warnungen je 1000 Codezeilen auf 7 Pakete verteilt, M2004\cite{hatton2007language}}
        \label{fig:2004-transgression-rates}
    \end{figure}

    \section{Konklusion}
    \label{sec:konklusion}

    %TODO Add conclusion

    %%
    %% Bibliography
    %%

    %% Please use bibtex,

    \bibliography{prosem}

\end{document}
